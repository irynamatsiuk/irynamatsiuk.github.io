<!-- Home link (only for xs screens)-->
<a href="/home" class="d-sm-none"><h4 class="mb-4 text-center">Home</h4></a>

<!-- New folder and upload file patials -->
<div class="text-center mt-3">
  <button class="btn btn-sm btn-outline-primary close-forms d-none mb-3">
    Close
  </button>
  <div class="container new-folder d-none">
    <%- include('partials/newFolder') %>
  </div>
  <div class="container upload-file d-none">
    <%- include('partials/uploadFile') %>
  </div>
  <button
    class="btn btn-lg btn-outline-primary open-forms"
    aria-label="Create new folder or upload file"
  >
    +
  </button>
</div>

<!-- All folders -->
<div class="container mb-3">
  <div class="row justify-content-center">
    <div class="col-sm-11 col-md-10 col-lg-8">
      <h4 class="mt-5 text-center">My folders:</h4>
      <% if (folders.length === 0) { %>
      <p class="text-center text-muted">no folders yet</p>
      <% } else { %>
      <ul class="list-group mb-4">
        <% folders.forEach(folder => { %>
        <li
          class="list-group-item d-flex justify-content-between align-items-start"
        >
          <!-- Rename folder form -->
          <form
            class="rename-form d-flex flex-column flex-grow-1 me-2"
            method="POST"
            action="/folders/update-<%= folder.id %>?_method=PATCH"
          >
            <div class="d-flex justify-content-between align-items-center mb-2">
              <a href="/folders/folder-<%= folder.id %>/files">
                <span class="folder-name fw-medium"><%= folder.name %></span>
              </a>
              <span class="folder-items small ms-2 text-secondary">
                <% if (folder.files.length === 1) { %> (1&nbsp;file) <% } else {
                %> (<%= folder.files.length %>&nbsp;files) <% } %>
              </span>
            </div>

            <input
              type="text"
              name="newName"
              class="form-control form-control-sm rename-input d-none"
              value="<%= folder.name %>"
              required
            />

            <div class="d-flex justify-content-between mt-2">
              <button type="button" class="btn btn-sm btn-secondary rename-btn">
                Rename
              </button>
              <button
                type="submit"
                class="btn btn-sm btn-success save-btn d-none"
              >
                Save
              </button>
            </div>
          </form>

          <!-- Delete folder form -->
          <form
            method="POST"
            action="/folders/delete-<%= folder.id %>?_method=DELETE"
            class="ms-2 mb-auto"
            onsubmit="return confirm('Are you sure you want to delete this folder?');"
          >
            <button
              class="text-danger bg-transparent border-0"
              aria-label="Delete folder"
            >
              <i class="bi bi-trash-fill"></i>
            </button>
          </form>
        </li>
        <% }) %>
      </ul>
      <% } %>
    </div>
  </div>
</div>

<!-- Files without folders -->
<div class="container mb-5">
  <div class="row justify-content-center">
    <div class="col-sm-11 col-md-10 col-lg-8">
      <% if (files.length > 0) { %>
      <h4>Lonely files:</h4>
      <ul class="list-group">
        <% files.forEach(file => { %> <%- include('partials/fileListItem',
        {file: file}) %> <% }) %>
      </ul>
      <% } %>
    </div>
  </div>
</div>

<script src="/js/folders.js"></script>
